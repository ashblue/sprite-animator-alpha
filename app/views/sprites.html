<main-nav></main-nav>

<div class="container">
    <h1>Sprite Sheets</h1>
    <p>You can't create an animation without an assembled sprite sheet. Here you can add new images and slice them into sprite sheets.</p>

    <div class="row">
        <form ng-controller="UploadController as uploadCtrl" name="spriteForm" id="form-upload" ng-submit="spriteForm.$valid && uploadCtrl.imageReady && uploadCtrl.addUpload(uploadCtrl.upload)">
            <div class="col-md-4">
                <div id="slice-lines-container">
                    <img id="upload-preview" ng-src="{{uploadCtrl.upload.image}}" ng-hide="uploadCtrl.imageReady" />
                    <div id="canvas-upload-preview" ng-show="uploadCtrl.imageReady"></div>
                    <canvas id="canvas-slice" class="slice-lines" ng-show="uploadCtrl.imageReady"></canvas>
                </div>
                <button class="btn btn-default" ng-show="uploadCtrl.imageReady" ng-click="uploadCtrl.clearImage()">Clear Image</button>
            </div>

            <div class="col-md-8">

                <div class="form-group">
                    <label for="sprite-name">Name</label>
                    <input class="form-control" id="sprite-name" type="text" required ng-model="uploadCtrl.upload.name" />
                </div>

                <div class="form-group" ng-hide="uploadCtrl.imageReady">
                    <label for="sprite-file">Image File</label>
                    <input accept="image/*" id="sprite-file" type="file" ng-model="uploadCtrl"
                           onchange="angular.element(this).scope().uploadCtrl.imageUpload(this)"/>
                </div>

                <div class="form-group">
                    <label for="sprite-rows">Rows</label>
                    <input ng-change="uploadCtrl.setSlice()" min="1" id="sprite-rows" class="form-control" required type="number" ng-model="uploadCtrl.upload.rows" />
                </div>

                <div class="form-group">
                    <label for="sprite-cols">Columns</label>
                    <input ng-change="uploadCtrl.setSlice()" min="1" id="sprite-cols" class="form-control" required type="number" ng-model="uploadCtrl.upload.cols" />
                </div>

                <input ng-model="uploadCtrl.upload.image_id" type="hidden" />

                <button type="submit" class="btn btn-primary">Submit</button>

            </div>
        </form>
    </div>

    <div class="row" id="sprite-sheets">
        <div class="col-md-6">
            <image-list></image-list>
        </div>

        <div ng-controller="SpriteCtrl as sprites" class="col-md-6">
            <h2>Sprite Sheets <small>Images ready for animating</small></h2>
            <input style="margin-bottom: 10px" class="form-control" type="search" ng-model="spriteSearch" placeholder="Filter">
            <div class="list-group" ng-repeat="sprite in spriteSheet.sprites | filter:spriteSearch">
                <a href="#" class="list-group-item">
                <span class="pull-left" style="margin-right: 10px">
                    <img ng-src="{{spriteSheet.getImageSrc(sprite.image)}}" />
                </span>
                    <div class="media-body">
                        <h4 class="media-heading">{{sprite.name}}</h4>
                        F-Width: {{sprite.width}}, F-Height: {{sprite.height}}
                        <button ng-click="spriteSheet.editSprite($event, sprite)" class="btn btn-default btn-xs pull-right"><span class="glyphicon glyphicon-edit"></span></button>
                        <button ng-click="spriteSheet.removeSprite($event, sprite)" style="margin-right: 5px;" class="btn btn-danger btn-xs pull-right"><span class="glyphicon glyphicon-remove"></span></button>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>